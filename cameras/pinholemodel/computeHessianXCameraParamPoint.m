function hess_x_cam_pt = computeHessianXCameraParamPoint(point, cameraparams)
%COMPUTEHESSIANXCAMERAPARAMPOINT
%    HESS_X_CAM_PT = COMPUTEHESSIANXCAMERAPARAMPOINT(X,Y,Z,FX,TX,TZ,WX,WY,WZ,X0)

%    This function was generated by the Symbolic Math Toolbox version 8.0.
%    01-Dec-2018 12:28:43

X = point(1);
Y = point(2);
Z = point(3);
fx = cameraparams(1);
fy = cameraparams(2);
x0 = cameraparams(3);
y0 = cameraparams(4);
wx = cameraparams(5);
wy = cameraparams(6);
wz = cameraparams(7);
tx = cameraparams(8);
ty = cameraparams(9);
tz = cameraparams(10);


if (0.0 < wx.^2+wy.^2+wz.^2)
    t0 = -(fx.*(wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*(Z.*(fx.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))-X.*(fx.*(wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0).*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))-(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t0 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t1 = -(fx.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))-1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)).*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))+(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*(-X.*(fx.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))-x0.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t1 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t2 = (x0.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-fx.*((wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*(X.*(x0.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-fx.*((wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(x0.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+fx.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0).*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))-(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).*(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t2 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t3 = fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t3 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t4 = -(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0+x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t4 = -fx.*1.0./(Z+tz).^2;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t5 = (fx.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*(Z.*(fx.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))-X.*(fx.*(wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)).*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))+(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t5 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t6 = (fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0).*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))-(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*(-X.*(fx.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))-x0.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t6 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t7 = (x0.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+fx.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))-(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*(X.*(x0.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-fx.*((wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(x0.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+fx.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0).*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))+(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).*(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t7 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t8 = -fx.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t8 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t9 = (fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t9 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t10 = (fx.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0).*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))-(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0).*(Z.*(fx.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))-X.*(fx.*(wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t10 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t11 = (fx.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))-x0.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))-(-X.*(fx.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))-x0.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0).*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))-(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t11 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t12 = (fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))-(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).*(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0).*(X.*(x0.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-fx.*((wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(x0.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+fx.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0).*(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t12 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t13 = -fx.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t13 = -fx.*1.0./(Z+tz).^2;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t14 = -(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t14 = 1.0./(Z+tz).^3.*(X.*fx+Z.*x0+fx.*tx+tz.*x0).*2.0-x0.*1.0./(Z+tz).^2.*2.0;
end
hess_x_cam_pt = reshape([t0,t1,t2,t3,0.0,t4,t5,t6,t7,t8,0.0,t9,t10,t11,t12,t13,0.0,t14],[6,3]);
