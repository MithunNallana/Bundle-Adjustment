function hess_x_cam_cam = computeHessianXCameraParamCameraParam(point, cameraparams)
%COMPUTEHESSIANXCAMERAPARAMCAMERAPARAM
%    HESS_X_CAM_CAM = COMPUTEHESSIANXCAMERAPARAMCAMERAPARAM(X,Y,Z,FX,TX,TZ,WX,WY,WZ,X0)

%    This function was generated by the Symbolic Math Toolbox version 8.0.
%    01-Dec-2018 12:28:37

X = point(1);
Y = point(2);
Z = point(3);
fx = cameraparams(1);
fy = cameraparams(2);
x0 = cameraparams(3);
y0 = cameraparams(4);
wx = cameraparams(5);
wy = cameraparams(6);
wz = cameraparams(7);
tx = cameraparams(8);
ty = cameraparams(9);
tz = cameraparams(10);



if (0.0 < wx.^2+wy.^2+wz.^2)
    t0 = -(X.*(fx.*(wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0-wx.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2)-x0.*(-(wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0+wx.^2.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*6.0+wx.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-wx.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))+Z.*(x0.*((cos(sqrt(wx.^2+wy.^2+wz.^2)).*-2.0+2.0)./(wx.^2+wy.^2+wz.^2)+wx.^4.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*5.0-wx.^4.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*1.0e1-wx.^4.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2)-fx.*((wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0-wx.^2.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*6.0+wx.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-wx.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))-Y.*(fx.*(-(wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*6.0+wx.^3.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.^3.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-wx.^3.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)-x0.*(wx.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-(wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*3.0)./(wx.^2+wy.^2+wz.^2)+wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))-(Z.*(fx.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))-X.*(fx.*(wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*2.0+(Z.*((cos(sqrt(wx.^2+wy.^2+wz.^2)).*-2.0+2.0)./(wx.^2+wy.^2+wz.^2)+wx.^4.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*5.0-wx.^4.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*1.0e1-wx.^4.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2)-X.*(-(wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0+wx.^2.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*6.0+wx.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-wx.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+Y.*(wx.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-(wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*3.0)./(wx.^2+wy.^2+wz.^2)+wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))+(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).^2.*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t0 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t1 = (Y.*(x0.*((wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.^2.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+fx.*(-(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0)./(wx.^2+wy.^2+wz.^2)+wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0))+X.*(x0.*(-(wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)-fx.*(wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*2.0+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*4.0+wx.*wy.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))+Z.*(fx.*((wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)-x0.*(wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*4.0+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*8.0+wx.*wy.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^3.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^3.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0-wx.^3.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))-(Z.*(fx.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))-X.*(fx.*(wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(X.*(-(wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+Y.*((wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.^2.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)-Z.*(wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*4.0+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*8.0+wx.*wy.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^3.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^3.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0-wx.^3.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))-(-X.*(fx.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))-x0.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t1 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t2 = (Y.*(fx.*(-(wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+x0.*((wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))+X.*(x0.*(-(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0)./(wx.^2+wy.^2+wz.^2)+wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0)-fx.*(wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*2.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*4.0+wx.*wz.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))+Z.*(fx.*(-(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0)./(wx.^2+wy.^2+wz.^2)+wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0)-x0.*(wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*2.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*4.0+wx.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))-(X.*(x0.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-fx.*((wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(x0.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+fx.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(Y.*((wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+X.*(-(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0)./(wx.^2+wy.^2+wz.^2)+wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0)-Z.*(wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*2.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*4.0+wx.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))-(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*(Z.*(fx.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))-X.*(fx.*(wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t2 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t3 = -fx.*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t3 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t4 = -(Z.*(fx.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))-X.*(fx.*(wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-x0.*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t4 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t5 = (Y.*(x0.*((wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.^2.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+fx.*(-(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0)./(wx.^2+wy.^2+wz.^2)+wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0))+X.*(x0.*(-(wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)-fx.*(wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*2.0+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*4.0+wx.*wy.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))+Z.*(fx.*((wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)-x0.*(wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*4.0+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*8.0+wx.*wy.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^3.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^3.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0-wx.^3.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))-(Z.*(fx.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))-X.*(fx.*(wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(X.*(-(wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+Y.*((wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.^2.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)-Z.*(wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*4.0+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*8.0+wx.*wy.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^3.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^3.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0-wx.^3.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))-(-X.*(fx.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))-x0.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t5 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t6 = -(X.*(fx.*((cos(sqrt(wx.^2+wy.^2+wz.^2)).*-2.0+2.0)./(wx.^2+wy.^2+wz.^2)+wy.^4.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*5.0-wy.^4.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*1.0e1-wy.^4.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wy.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wy.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2)-x0.*(wy.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-(wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*3.0)./(wx.^2+wy.^2+wz.^2)+wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))+Z.*(x0.*((cos(sqrt(wx.^2+wy.^2+wz.^2)).*-2.0+2.0)./(wx.^2+wy.^2+wz.^2)+wy.^4.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*5.0-wy.^4.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*1.0e1-wy.^4.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0-wx.^2.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2)+fx.*(wy.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-(wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*3.0)./(wx.^2+wy.^2+wz.^2)+wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))-Y.*(fx.*(-(wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*6.0+wx.*wy.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.*wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-wx.*wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+x0.*((wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0-wx.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*6.0+wy.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-wy.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))-(-Z.*((cos(sqrt(wx.^2+wy.^2+wz.^2)).*-2.0+2.0)./(wx.^2+wy.^2+wz.^2)+wy.^4.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*5.0-wy.^4.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*1.0e1-wy.^4.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0-wx.^2.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2)+X.*(wy.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-(wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*3.0)./(wx.^2+wy.^2+wz.^2)+wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+Y.*((wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0-wx.*wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*6.0+wy.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-wy.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))-(-X.*(fx.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))-x0.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*2.0+(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).^2.*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t6 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t7 = (Y.*(fx.*(-(wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+x0.*(-(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0)./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wy.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wy.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0))+Z.*(fx.*((wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)-x0.*(wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*2.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*4.0+wy.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wy.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))+X.*(x0.*(-(wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)-fx.*(wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*4.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*8.0+wy.*wz.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wy.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wy.*wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.*wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0-wy.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))-(-X.*(fx.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))-x0.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(X.*(x0.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-fx.*((wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(x0.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+fx.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(X.*(-(wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+Y.*(-(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0)./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wy.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wy.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0)-Z.*(wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*2.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*4.0+wy.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wy.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))+(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t7 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t8 = -fx.*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t8 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t9 = -(-X.*(fx.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))-x0.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-x0.*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t9 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t10 = (Y.*(fx.*(-(wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+x0.*((wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))+X.*(x0.*(-(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0)./(wx.^2+wy.^2+wz.^2)+wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0)-fx.*(wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*2.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*4.0+wx.*wz.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))+Z.*(fx.*(-(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0)./(wx.^2+wy.^2+wz.^2)+wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0)-x0.*(wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*2.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*4.0+wx.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))-(X.*(x0.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-fx.*((wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(x0.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+fx.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(Y.*((wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+X.*(-(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0)./(wx.^2+wy.^2+wz.^2)+wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wx.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0)-Z.*(wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*2.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*4.0+wx.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))-(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*(Z.*(fx.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))-X.*(fx.*(wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t10 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t11 = (Y.*(fx.*(-(wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+x0.*(-(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0)./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wy.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wy.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0))+Z.*(fx.*((wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)-x0.*(wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*2.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*4.0+wy.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wy.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))+X.*(x0.*(-(wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)-fx.*(wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*4.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*8.0+wy.*wz.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wy.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wy.*wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.*wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0-wy.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))-(-X.*(fx.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))-x0.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(X.*(x0.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-fx.*((wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(x0.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+fx.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-(X.*(-(wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+Y.*(-(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0)./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wy.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wy.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0)-Z.*(wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*2.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*4.0+wy.^3.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wy.^3.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^3.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.^2.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))+(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t11 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t12 = -(Z.*(x0.*(wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0-wy.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wy.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2)-fx.*((wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*6.0+wx.*wz.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.*wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-wx.*wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))+X.*(fx.*((cos(sqrt(wx.^2+wy.^2+wz.^2)).*-2.0+2.0)./(wx.^2+wy.^2+wz.^2)+wz.^4.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*5.0-wz.^4.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*1.0e1-wz.^4.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0-wy.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wy.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2)-x0.*(-(wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*6.0+wx.*wz.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.*wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-wx.*wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0))-Y.*(fx.*(wz.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-(wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*3.0)./(wx.^2+wy.^2+wz.^2)+wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.*wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+x0.*((wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0-wx.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*6.0+wy.*wz.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-wy.*wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.*wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)))./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).^2.*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0-(-Z.*(wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0-wx.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.^2.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wx.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0-wy.^2.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0+wx.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wy.^2.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2)+X.*(-(wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0+wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*6.0+wx.*wz.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2+wy.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0-wx.*wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)-wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-wx.*wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)+Y.*((wx.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0).*3.0-wx.*wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2.*3.0+wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*6.0+wy.*wz.^3.*cos(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^2-wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*3.0-wy.*wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(5.0./2.0).*5.0-wy.*wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^3.*8.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))))-(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*(X.*(x0.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-fx.*((wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(x0.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+fx.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*2.0;
else
    t12 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t13 = -fx.*(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t13 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t14 = -(X.*(x0.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-fx.*((wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(x0.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+fx.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0-x0.*(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t14 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t15 = -fx.*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t15 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t16 = -fx.*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t16 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t17 = -fx.*(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t17 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t18 = -fx.*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t18 = -fx.*1.0./(Z+tz).^2;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t19 = -(Z.*(fx.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))-X.*(fx.*(wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-x0.*(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(X.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wx.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t19 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t20 = -(-X.*(fx.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))-x0.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+x0.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2-x0.*(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(Y.*(-(wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wy.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-Z.*((wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wy.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.^2.*wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t20 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t21 = -(X.*(x0.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-fx.*((wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*-2.0)./(wx.^2+wy.^2+wz.^2)+wz.^3.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wz.^3.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))+Y.*(x0.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+fx.*(-sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wz.^2.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wx.*wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)))+Z.*(fx.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)-x0.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0))).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2+(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0-x0.*(-Z.*(wx.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.^2.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0+wy.^2.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+X.*(-(wx.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)-(wy.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)+wy.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wx.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)+Y.*(-(wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wx.*wz.*cos(sqrt(wx.^2+wy.^2+wz.^2)))./(wx.^2+wy.^2+wz.^2)-wx.*wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./(wx.^2+wy.^2+wz.^2).^(3.0./2.0)+wy.*wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0).*1.0./(wx.^2+wy.^2+wz.^2).^2.*2.0)).*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t21 = 0.0;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t22 = -fx.*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2;
else
    t22 = -fx.*1.0./(Z+tz).^2;
end
if (0.0 < wx.^2+wy.^2+wz.^2)
    t23 = x0.*1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^2.*-2.0+1.0./(tz+Z.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-X.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))+Y.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))).^3.*(fx.*tx-Y.*(fx.*(wz.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wy.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2))-x0.*(wx.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wy.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+tz.*x0+X.*(fx.*((wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wz.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)-x0.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)+(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))+Z.*(x0.*((wx.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+(wy.^2.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)+1.0)+fx.*(wy.*sin(sqrt(wx.^2+wy.^2+wz.^2)).*1.0./sqrt(wx.^2+wy.^2+wz.^2)-(wx.*wz.*(cos(sqrt(wx.^2+wy.^2+wz.^2))-1.0))./(wx.^2+wy.^2+wz.^2)))).*2.0;
else
    t23 = 1.0./(Z+tz).^3.*(X.*fx+Z.*x0+fx.*tx+tz.*x0).*2.0-x0.*1.0./(Z+tz).^2.*2.0;
end
hess_x_cam_cam = reshape([t0,t1,t2,t3,0.0,t4,t5,t6,t7,t8,0.0,t9,t10,t11,t12,t13,0.0,t14,t15,t16,t17,0.0,0.0,t18,0.0,0.0,0.0,0.0,0.0,0.0,t19,t20,t21,t22,0.0,t23],[6,6]);
